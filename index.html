<!doctype html>
<html lang="es" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dobble Vitrasa</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;900&amp;display=swap" rel="stylesheet">
  <style>
    body {
      box-sizing: border-box;
    }
    * {
      font-family: 'Nunito', sans-serif;
    }
    .card-container {
      perspective: 1000px;
    }
    .card {
      transition: transform 0.6s, box-shadow 0.3s;
      transform-style: preserve-3d;
    }
    .card:hover {
      box-shadow: 0 20px 40px rgba(0,0,0,0.2);
    }
    .symbol {
      transition: all 0.2s ease;
      cursor: pointer;
    }
    .symbol:hover {
      transform: scale(1.15);
      filter: brightness(1.1);
    }
    .symbol.correct {
      animation: pulse-correct 0.5s ease;
    }
    .symbol.wrong {
      animation: shake 0.5s ease;
    }
    @keyframes pulse-correct {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.3); }
    }
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-10px); }
      75% { transform: translateX(10px); }
    }
    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
    }
    .floating {
      animation: float 3s ease-in-out infinite;
    }
    @keyframes confetti-fall {
      0% { transform: translateY(-100%) rotate(0deg); opacity: 1; }
      100% { transform: translateY(100%) rotate(720deg); opacity: 0; }
    }
    .confetti {
      position: absolute;
      width: 10px;
      height: 10px;
      animation: confetti-fall 1s ease-out forwards;
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full overflow-auto">
  <div id="app" class="min-h-full w-full flex flex-col items-center justify-center p-4" style="background: linear-gradient(135deg, #1a5f2a 0%, #2d8a3e 50%, #1a5f2a 100%);"><!-- Header -->
   <div class="text-center mb-6">
    <h1 id="game-title" class="text-4xl md:text-5xl font-black text-white drop-shadow-lg mb-2">üöç Dobble Vitrasa üöç</h1>
    <p id="instruction-text" class="text-xl text-green-100 font-bold">¬°Encuentra el s√≠mbolo com√∫n entre las dos cartas!</p>
   </div><!-- Score and Timer -->
   <div class="flex gap-6 mb-6">
    <div class="bg-white/20 backdrop-blur-sm rounded-2xl px-6 py-3 text-center">
     <p class="text-green-100 text-sm font-bold">PUNTOS</p>
     <p id="score" class="text-3xl font-black text-white">0</p>
    </div>
    <div class="bg-white/20 backdrop-blur-sm rounded-2xl px-6 py-3 text-center">
     <p class="text-green-100 text-sm font-bold">TIEMPO</p>
     <p id="timer" class="text-3xl font-black text-white">60</p>
    </div>
    <div class="bg-white/20 backdrop-blur-sm rounded-2xl px-6 py-3 text-center">
     <p class="text-green-100 text-sm font-bold">RACHA</p>
     <p id="streak" class="text-3xl font-black text-yellow-300">0</p>
    </div>
   </div><!-- Game Area -->
   <div id="game-area" class="flex flex-col md:flex-row gap-6 md:gap-12 items-center justify-center"><!-- Card 1 -->
    <div class="card-container">
     <div id="card1" class="card w-64 h-64 md:w-72 md:h-72 bg-white rounded-full shadow-2xl flex items-center justify-center relative border-8 border-green-600 floating" style="animation-delay: 0s;"><!-- Symbols will be inserted here -->
     </div>
    </div><!-- VS Badge -->
    <div class="bg-yellow-400 text-green-800 font-black text-2xl px-4 py-2 rounded-full shadow-lg transform rotate-12">
     VS
    </div><!-- Card 2 -->
    <div class="card-container">
     <div id="card2" class="card w-64 h-64 md:w-72 md:h-72 bg-white rounded-full shadow-2xl flex items-center justify-center relative border-8 border-green-600 floating" style="animation-delay: 0.5s;"><!-- Symbols will be inserted here -->
     </div>
    </div>
   </div><!-- Feedback -->
   <div id="feedback" class="mt-6 h-12 flex items-center justify-center">
    <p id="feedback-text" class="text-2xl font-black text-white drop-shadow-lg"></p>
   </div><!-- Start/Restart Button --> <button id="start-btn" class="mt-4 bg-yellow-400 hover:bg-yellow-300 text-green-800 font-black text-xl px-8 py-4 rounded-full shadow-lg transform transition hover:scale-105 active:scale-95"> üéÆ ¬°EMPEZAR! </button> <!-- Game Over Modal -->
   <div id="game-over" class="hidden fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4">
    <div class="bg-white rounded-3xl p-8 text-center max-w-md w-full shadow-2xl">
     <h2 class="text-4xl font-black text-green-600 mb-4">üéâ ¬°Fin del juego!</h2>
     <div class="bg-green-100 rounded-2xl p-6 mb-6">
      <p class="text-green-600 font-bold text-lg">Puntuaci√≥n final</p>
      <p id="final-score" class="text-6xl font-black text-green-700">0</p>
     </div>
     <p id="final-message" class="text-gray-600 text-lg mb-6">¬°Buen viaje con Vitrasa!</p><button id="restart-btn" class="bg-green-600 hover:bg-green-500 text-white font-black text-xl px-8 py-4 rounded-full shadow-lg transform transition hover:scale-105"> üîÑ Jugar de nuevo </button>
    </div>
   </div><!-- Confetti Container -->
   <div id="confetti-container" class="fixed inset-0 pointer-events-none overflow-hidden z-40"></div>
  </div>
  <script>
    // Vitrasa themed symbols as SVG
    const vitrasaSymbols = [
      { id: 'bus', name: 'Autob√∫s', svg: `<svg viewBox="0 0 64 64" class="w-full h-full"><rect x="8" y="16" width="48" height="32" rx="4" fill="#2d8a3e"/><rect x="12" y="20" width="12" height="10" rx="2" fill="#87CEEB"/><rect x="28" y="20" width="12" height="10" rx="2" fill="#87CEEB"/><rect x="44" y="20" width="8" height="10" rx="2" fill="#87CEEB"/><circle cx="18" cy="48" r="5" fill="#333"/><circle cx="46" cy="48" r="5" fill="#333"/><rect x="4" y="24" width="4" height="8" rx="1" fill="#FFD700"/><rect x="56" y="24" width="4" height="8" rx="1" fill="#FF4444"/></svg>` },
      { id: 'ticket', name: 'Billete', svg: `<svg viewBox="0 0 64 64" class="w-full h-full"><rect x="8" y="18" width="48" height="28" rx="4" fill="#FFD700"/><rect x="8" y="28" width="48" height="2" fill="#FFA500" stroke-dasharray="4"/><text x="32" y="24" text-anchor="middle" font-size="8" font-weight="bold" fill="#2d8a3e">VITRASA</text><text x="32" y="40" text-anchor="middle" font-size="6" fill="#666">BILLETE</text><circle cx="12" cy="32" r="4" fill="white"/><circle cx="52" cy="32" r="4" fill="white"/></svg>` },
      { id: 'stop', name: 'Parada', svg: `<svg viewBox="0 0 64 64" class="w-full h-full"><rect x="28" y="20" width="8" height="36" fill="#666"/><rect x="20" y="12" width="24" height="20" rx="3" fill="#2d8a3e"/><text x="32" y="26" text-anchor="middle" font-size="8" font-weight="bold" fill="white">BUS</text><rect x="24" y="56" width="16" height="4" rx="2" fill="#888"/></svg>` },
      { id: 'driver', name: 'Conductor', svg: `<svg viewBox="0 0 64 64" class="w-full h-full"><circle cx="32" cy="20" r="12" fill="#FFE4C4"/><ellipse cx="32" cy="48" rx="16" ry="12" fill="#2d8a3e"/><rect x="24" y="8" width="16" height="8" rx="2" fill="#1a5f2a"/><circle cx="28" cy="18" r="2" fill="#333"/><circle cx="36" cy="18" r="2" fill="#333"/><path d="M28 24 Q32 28 36 24" stroke="#333" stroke-width="2" fill="none"/></svg>` },
      { id: 'card', name: 'Tarjeta', svg: `<svg viewBox="0 0 64 64" class="w-full h-full"><rect x="10" y="18" width="44" height="28" rx="4" fill="#4169E1"/><rect x="14" y="34" width="20" height="4" rx="1" fill="#FFD700"/><rect x="14" y="40" width="12" height="2" rx="1" fill="white" opacity="0.7"/><circle cx="44" cy="28" r="6" fill="#FFD700"/><text x="44" y="31" text-anchor="middle" font-size="8" font-weight="bold" fill="#4169E1">V</text></svg>` },
      { id: 'wheel', name: 'Rueda', svg: `<svg viewBox="0 0 64 64" class="w-full h-full"><circle cx="32" cy="32" r="24" fill="#333"/><circle cx="32" cy="32" r="18" fill="#666"/><circle cx="32" cy="32" r="8" fill="#888"/><circle cx="32" cy="32" r="4" fill="#333"/><rect x="30" y="8" width="4" height="12" fill="#888"/><rect x="30" y="44" width="4" height="12" fill="#888"/><rect x="8" y="30" width="12" height="4" fill="#888"/><rect x="44" y="30" width="12" height="4" fill="#888"/></svg>` },
      { id: 'clock', name: 'Horario', svg: `<svg viewBox="0 0 64 64" class="w-full h-full"><circle cx="32" cy="32" r="24" fill="white" stroke="#2d8a3e" stroke-width="4"/><line x1="32" y1="32" x2="32" y2="18" stroke="#2d8a3e" stroke-width="3" stroke-linecap="round"/><line x1="32" y1="32" x2="42" y2="32" stroke="#2d8a3e" stroke-width="3" stroke-linecap="round"/><circle cx="32" cy="32" r="3" fill="#2d8a3e"/></svg>` },
      { id: 'map', name: 'Mapa', svg: `<svg viewBox="0 0 64 64" class="w-full h-full"><rect x="10" y="12" width="44" height="40" rx="2" fill="#F5F5DC"/><path d="M18 16 L18 44 L30 36 L30 16 Z" fill="#2d8a3e" opacity="0.5"/><path d="M30 16 L30 36 L46 44 L46 16 Z" fill="#4169E1" opacity="0.5"/><circle cx="38" cy="28" r="4" fill="#FF4444"/><path d="M38 24 L38 20" stroke="#FF4444" stroke-width="2"/></svg>` },
      { id: 'euro', name: 'Euro', svg: `<svg viewBox="0 0 64 64" class="w-full h-full"><circle cx="32" cy="32" r="22" fill="#FFD700"/><text x="32" y="42" text-anchor="middle" font-size="28" font-weight="bold" fill="#2d8a3e">‚Ç¨</text></svg>` },
      { id: 'phone', name: 'App', svg: `<svg viewBox="0 0 64 64" class="w-full h-full"><rect x="18" y="8" width="28" height="48" rx="4" fill="#333"/><rect x="22" y="14" width="20" height="32" rx="2" fill="#2d8a3e"/><circle cx="32" cy="52" r="3" fill="#666"/><text x="32" y="34" text-anchor="middle" font-size="10" font-weight="bold" fill="white">APP</text></svg>` },
      { id: 'bell', name: 'Timbre', svg: `<svg viewBox="0 0 64 64" class="w-full h-full"><path d="M32 8 L32 14" stroke="#FFD700" stroke-width="3"/><path d="M20 28 C20 18 26 14 32 14 C38 14 44 18 44 28 L44 40 L20 40 Z" fill="#FFD700"/><rect x="16" y="40" width="32" height="6" rx="2" fill="#FFD700"/><ellipse cx="32" cy="50" rx="6" ry="4" fill="#FFD700"/></svg>` },
      { id: 'seat', name: 'Asiento', svg: `<svg viewBox="0 0 64 64" class="w-full h-full"><rect x="18" y="24" width="28" height="24" rx="4" fill="#4169E1"/><rect x="20" y="12" width="24" height="16" rx="4" fill="#4169E1"/><rect x="16" y="48" width="6" height="8" rx="2" fill="#333"/><rect x="42" y="48" width="6" height="8" rx="2" fill="#333"/></svg>` },
      { id: 'bridge', name: 'Puente', svg: `<svg viewBox="0 0 64 64" class="w-full h-full"><path d="M4 48 L16 28 L32 20 L48 28 L60 48" stroke="#666" stroke-width="4" fill="none"/><line x1="16" y1="28" x2="16" y2="48" stroke="#666" stroke-width="3"/><line x1="32" y1="20" x2="32" y2="48" stroke="#666" stroke-width="3"/><line x1="48" y1="28" x2="48" y2="48" stroke="#666" stroke-width="3"/><rect x="0" y="48" width="64" height="4" fill="#666"/></svg>` },
      { id: 'vigo', name: 'Vigo', svg: `<svg viewBox="0 0 64 64" class="w-full h-full"><circle cx="32" cy="32" r="24" fill="#1a5f2a"/><text x="32" y="28" text-anchor="middle" font-size="10" font-weight="bold" fill="white">VIGO</text><text x="32" y="42" text-anchor="middle" font-size="8" fill="#FFD700">‚≠ê‚≠ê‚≠ê</text></svg>` },
      { id: 'tree', name: 'Castrelos', svg: `<svg viewBox="0 0 64 64" class="w-full h-full"><rect x="28" y="40" width="8" height="16" fill="#8B4513"/><path d="M32 8 L48 40 L16 40 Z" fill="#2d8a3e"/><circle cx="24" cy="28" r="3" fill="#FF6B6B"/><circle cx="38" cy="32" r="2" fill="#FFD700"/></svg>` },
      { id: 'beach', name: 'Playa', svg: `<svg viewBox="0 0 64 64" class="w-full h-full"><rect x="0" y="40" width="64" height="24" fill="#F4D03F"/><rect x="0" y="32" width="64" height="12" fill="#3498DB"/><circle cx="50" cy="16" r="10" fill="#FFD700"/><path d="M8 56 L16 32 L24 56" stroke="#8B4513" stroke-width="3" fill="none"/><path d="M8 40 Q16 36 24 40" stroke="#E74C3C" stroke-width="2" fill="none"/></svg>` },
      { id: 'fish', name: 'Pescado', svg: `<svg viewBox="0 0 64 64" class="w-full h-full"><ellipse cx="28" cy="32" rx="20" ry="12" fill="#3498DB"/><path d="M48 32 L60 20 L60 44 Z" fill="#3498DB"/><circle cx="18" cy="30" r="3" fill="white"/><circle cx="18" cy="30" r="1.5" fill="#333"/><path d="M24 36 Q32 40 40 36" stroke="#1a5f2a" stroke-width="2" fill="none"/></svg>` },
      { id: 'lighthouse', name: 'Faro', svg: `<svg viewBox="0 0 64 64" class="w-full h-full"><rect x="24" y="24" width="16" height="32" fill="#E74C3C"/><rect x="24" y="32" width="16" height="4" fill="white"/><rect x="24" y="44" width="16" height="4" fill="white"/><rect x="20" y="20" width="24" height="8" fill="#F5F5DC"/><polygon points="32,8 40,20 24,20" fill="#FFD700"/><line x1="32" y1="8" x2="12" y2="4" stroke="#FFD700" stroke-width="2"/><line x1="32" y1="8" x2="52" y2="4" stroke="#FFD700" stroke-width="2"/></svg>` }
    ];

    // Game state
    let score = 0;
    let timeLeft = 60;
    let streak = 0;
    let gameRunning = false;
    let timerInterval = null;
    let currentMatch = null;
    let config = {};

    const defaultConfig = {
      game_title: 'üöç Dobble Vitrasa üöç',
      instruction_text: '¬°Encuentra el s√≠mbolo com√∫n entre las dos cartas!',
      background_color: '#1a5f2a',
      card_border_color: '#2d8a3e',
      text_color: '#ffffff',
      accent_color: '#FFD700',
      button_color: '#FFD700',
      font_family: 'Nunito'
    };

    // Initialize Element SDK
    window.elementSdk.init({
      defaultConfig,
      onConfigChange: async (newConfig) => {
        config = newConfig;
        applyConfig();
      },
      mapToCapabilities: (cfg) => ({
        recolorables: [
          {
            get: () => cfg.background_color || defaultConfig.background_color,
            set: (value) => window.elementSdk.setConfig({ background_color: value })
          },
          {
            get: () => cfg.card_border_color || defaultConfig.card_border_color,
            set: (value) => window.elementSdk.setConfig({ card_border_color: value })
          },
          {
            get: () => cfg.text_color || defaultConfig.text_color,
            set: (value) => window.elementSdk.setConfig({ text_color: value })
          },
          {
            get: () => cfg.accent_color || defaultConfig.accent_color,
            set: (value) => window.elementSdk.setConfig({ accent_color: value })
          },
          {
            get: () => cfg.button_color || defaultConfig.button_color,
            set: (value) => window.elementSdk.setConfig({ button_color: value })
          }
        ],
        borderables: [],
        fontEditable: {
          get: () => cfg.font_family || defaultConfig.font_family,
          set: (value) => window.elementSdk.setConfig({ font_family: value })
        },
        fontSizeable: undefined
      }),
      mapToEditPanelValues: (cfg) => new Map([
        ['game_title', cfg.game_title || defaultConfig.game_title],
        ['instruction_text', cfg.instruction_text || defaultConfig.instruction_text]
      ])
    });

    function applyConfig() {
      const bgColor = config.background_color || defaultConfig.background_color;
      const borderColor = config.card_border_color || defaultConfig.card_border_color;
      const textColor = config.text_color || defaultConfig.text_color;
      const accentColor = config.accent_color || defaultConfig.accent_color;
      const buttonColor = config.button_color || defaultConfig.button_color;
      const fontFamily = config.font_family || defaultConfig.font_family;

      const app = document.getElementById('app');
      app.style.background = `linear-gradient(135deg, ${bgColor} 0%, ${adjustBrightness(bgColor, 30)} 50%, ${bgColor} 100%)`;

      document.getElementById('game-title').textContent = config.game_title || defaultConfig.game_title;
      document.getElementById('game-title').style.color = textColor;
      document.getElementById('instruction-text').textContent = config.instruction_text || defaultConfig.instruction_text;
      document.getElementById('instruction-text').style.color = adjustBrightness(textColor, -20);

      document.querySelectorAll('.card').forEach(card => {
        card.style.borderColor = borderColor;
      });

      const startBtn = document.getElementById('start-btn');
      startBtn.style.backgroundColor = buttonColor;
      startBtn.style.color = bgColor;

      const restartBtn = document.getElementById('restart-btn');
      restartBtn.style.backgroundColor = borderColor;

      document.getElementById('streak').style.color = accentColor;

      // Apply font
      document.querySelectorAll('*').forEach(el => {
        el.style.fontFamily = `${fontFamily}, Nunito, sans-serif`;
      });
    }

    function adjustBrightness(hex, percent) {
      const num = parseInt(hex.replace('#', ''), 16);
      const amt = Math.round(2.55 * percent);
      const R = Math.min(255, Math.max(0, (num >> 16) + amt));
      const G = Math.min(255, Math.max(0, (num >> 8 & 0x00FF) + amt));
      const B = Math.min(255, Math.max(0, (num & 0x0000FF) + amt));
      return '#' + (0x1000000 + R * 0x10000 + G * 0x100 + B).toString(16).slice(1);
    }

    // Shuffle array
    function shuffle(array) {
      const arr = [...array];
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }

    // Generate card with symbols
    function generateCard(symbols, cardElement, isCard1) {
      cardElement.innerHTML = '';
      const positions = [
        { x: 50, y: 25, size: 28 },
        { x: 25, y: 50, size: 26 },
        { x: 75, y: 50, size: 26 },
        { x: 35, y: 75, size: 24 },
        { x: 65, y: 75, size: 24 },
        { x: 50, y: 50, size: 22 }
      ];

      const shuffledPositions = shuffle(positions);

      symbols.forEach((symbol, index) => {
        const pos = shuffledPositions[index];
        const rotation = Math.random() * 60 - 30;
        
        const symbolDiv = document.createElement('div');
        symbolDiv.className = 'symbol absolute';
        symbolDiv.style.cssText = `
          left: ${pos.x}%;
          top: ${pos.y}%;
          width: ${pos.size}%;
          height: ${pos.size}%;
          transform: translate(-50%, -50%) rotate(${rotation}deg);
        `;
        symbolDiv.innerHTML = symbol.svg;
        symbolDiv.dataset.symbolId = symbol.id;
        symbolDiv.title = symbol.name;
        
        symbolDiv.addEventListener('click', () => handleSymbolClick(symbol.id, symbolDiv));
        
        cardElement.appendChild(symbolDiv);
      });
    }

    // Generate new round
    function generateNewRound() {
      const shuffledSymbols = shuffle(vitrasaSymbols);
      
      // Pick 6 symbols for card 1
      const card1Symbols = shuffledSymbols.slice(0, 6);
      
      // Pick 5 different symbols + 1 matching symbol for card 2
      const matchingSymbol = card1Symbols[Math.floor(Math.random() * card1Symbols.length)];
      const remainingSymbols = shuffledSymbols.filter(s => !card1Symbols.includes(s));
      const card2Symbols = shuffle([matchingSymbol, ...remainingSymbols.slice(0, 5)]);
      
      currentMatch = matchingSymbol.id;
      
      generateCard(card1Symbols, document.getElementById('card1'), true);
      generateCard(card2Symbols, document.getElementById('card2'), false);
    }

    // Handle symbol click
    function handleSymbolClick(symbolId, element) {
      if (!gameRunning) return;
      
      if (symbolId === currentMatch) {
        // Correct!
        element.classList.add('correct');
        score += 10 + (streak * 2);
        streak++;
        
        document.getElementById('score').textContent = score;
        document.getElementById('streak').textContent = streak;
        
        showFeedback('¬°Correcto! +' + (10 + ((streak - 1) * 2)) + ' puntos', true);
        createConfetti();
        
        setTimeout(() => {
          generateNewRound();
        }, 500);
      } else {
        // Wrong!
        element.classList.add('wrong');
        streak = 0;
        document.getElementById('streak').textContent = streak;
        showFeedback('¬°Ese no es! Sigue buscando...', false);
        
        setTimeout(() => {
          element.classList.remove('wrong');
        }, 500);
      }
    }

    // Show feedback
    function showFeedback(message, isPositive) {
      const feedback = document.getElementById('feedback-text');
      feedback.textContent = message;
      feedback.style.color = isPositive ? '#FFD700' : '#FF6B6B';
      
      setTimeout(() => {
        feedback.textContent = '';
      }, 1500);
    }

    // Create confetti effect
    function createConfetti() {
      const container = document.getElementById('confetti-container');
      const colors = ['#FFD700', '#2d8a3e', '#FF6B6B', '#4169E1', '#FF69B4'];
      
      for (let i = 0; i < 20; i++) {
        const confetti = document.createElement('div');
        confetti.className = 'confetti';
        confetti.style.cssText = `
          left: ${Math.random() * 100}%;
          background-color: ${colors[Math.floor(Math.random() * colors.length)]};
          animation-delay: ${Math.random() * 0.5}s;
        `;
        container.appendChild(confetti);
        
        setTimeout(() => confetti.remove(), 1500);
      }
    }

    // Start game
    function startGame() {
      score = 0;
      timeLeft = 60;
      streak = 0;
      gameRunning = true;
      
      document.getElementById('score').textContent = score;
      document.getElementById('timer').textContent = timeLeft;
      document.getElementById('streak').textContent = streak;
      document.getElementById('start-btn').textContent = 'üéÆ Jugando...';
      document.getElementById('start-btn').disabled = true;
      document.getElementById('game-over').classList.add('hidden');
      
      generateNewRound();
      
      timerInterval = setInterval(() => {
        timeLeft--;
        document.getElementById('timer').textContent = timeLeft;
        
        if (timeLeft <= 10) {
          document.getElementById('timer').style.color = '#FF6B6B';
        }
        
        if (timeLeft <= 0) {
          endGame();
        }
      }, 1000);
    }

    // End game
    function endGame() {
      gameRunning = false;
      clearInterval(timerInterval);
      
      document.getElementById('start-btn').textContent = 'üéÆ ¬°EMPEZAR!';
      document.getElementById('start-btn').disabled = false;
      document.getElementById('timer').style.color = 'white';
      
      document.getElementById('final-score').textContent = score;
      
      let message = '';
      if (score >= 200) {
        message = 'üèÜ ¬°Eres un experto en Vitrasa! ¬°Incre√≠ble!';
      } else if (score >= 100) {
        message = 'üåü ¬°Muy bien! Conoces bien el transporte de Vigo.';
      } else if (score >= 50) {
        message = 'üëç ¬°Buen intento! Sigue practicando.';
      } else {
        message = 'üöå ¬°Sigue viajando con Vitrasa para mejorar!';
      }
      
      document.getElementById('final-message').textContent = message;
      document.getElementById('game-over').classList.remove('hidden');
      
      // Create celebration confetti
      for (let i = 0; i < 50; i++) {
        setTimeout(() => createConfetti(), i * 50);
      }
    }

    // Event listeners
    document.getElementById('start-btn').addEventListener('click', startGame);
    document.getElementById('restart-btn').addEventListener('click', () => {
      document.getElementById('game-over').classList.add('hidden');
      startGame();
    });

    // Initialize
    config = { ...defaultConfig };
    applyConfig();
    generateNewRound();
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9c4a520137ee0328',t:'MTc2OTUzODYxNi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
